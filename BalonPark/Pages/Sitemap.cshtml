@page "/sitemap"
@model SitemapModel
@{
    var settings = ViewData["SiteSettings"] as BalonPark.Models.Settings;
    var companyName = settings?.CompanyName ?? "Balon Park Şişme Oyun Grupları";
    ViewData["Title"] = "Site Haritası";
    ViewData["Description"] = $"{companyName} site haritası. Tüm sayfalar, kategoriler, ürünler ve blog yazılarına buradan ulaşabilirsiniz.";
    ViewData["Keywords"] = "site haritası, sitemap, tüm sayfalar, balon park, şişme oyun parkı";
    ViewData["Image"] = settings?.Logo != null ? (((IUrlService?)ViewData["UrlService"])?.GetImageUrl(settings.Logo) ?? settings.Logo) : (((IUrlService?)ViewData["UrlService"])?.GetImageUrl("/assets/images/logo/logo.png") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/assets/images/logo/logo.png");
}

<article class="space-y-12 md:space-y-16 pb-10" id="sitemap-page-content">
    @await Html.PartialAsync("Shared/_Breadcrumb", new List<BreadcrumbItem>
    {
        BreadcrumbItem.Link("Ana Sayfa", "/"),
        BreadcrumbItem.Current("Site Haritası")
    })

    <header class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
                <h1 class="text-3xl font-bold text-ink sm:text-4xl">Site Haritası</h1>
                <p class="mt-2 text-gray-600 max-w-2xl">Tüm sayfalar, kategoriler, ürünler ve blog yazılarına buradan ulaşabilirsiniz.</p>
            </div>
            <a href="/sitemap.xml" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-4 py-2.5 text-sm font-medium text-ink transition-colors hover:border-primary hover:bg-primary/5 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">
                <i data-lucide="file-code" class="w-4 h-4" aria-hidden="true"></i>
                XML Site Haritası
            </a>
        </div>
    </header>

    <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
        <!-- Ana Sayfalar -->
        <section aria-labelledby="sitemap-main-heading" class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
            <h2 id="sitemap-main-heading" class="mb-4 flex items-center gap-3 text-xl font-semibold text-ink">
                <span class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary" aria-hidden="true">
                    <i data-lucide="home" class="w-5 h-5"></i>
                </span>
                Ana Sayfalar
            </h2>
            <ul class="space-y-1" role="list">
                <li><a asp-page="/Index" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2"><i data-lucide="chevron-right" class="w-4 h-4 flex-shrink-0 text-gray-400"></i> Ana Sayfa</a></li>
                <li><a asp-page="/Hakkimizda" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2"><i data-lucide="chevron-right" class="w-4 h-4 flex-shrink-0 text-gray-400"></i> Hakkımızda</a></li>
                <li><a asp-page="/Iletisim" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2"><i data-lucide="chevron-right" class="w-4 h-4 flex-shrink-0 text-gray-400"></i> İletişim</a></li>
                <li><a asp-page="/Blog" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2"><i data-lucide="chevron-right" class="w-4 h-4 flex-shrink-0 text-gray-400"></i> Blog</a></li>
                <li><a asp-page="/Privacy" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2"><i data-lucide="chevron-right" class="w-4 h-4 flex-shrink-0 text-gray-400"></i> Gizlilik Politikası</a></li>
                <li><a asp-page="/KullanimKosullari" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2"><i data-lucide="chevron-right" class="w-4 h-4 flex-shrink-0 text-gray-400"></i> Kullanım Koşulları</a></li>
            </ul>
        </section>

        <!-- Kategoriler -->
        <section aria-labelledby="sitemap-categories-heading" class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
            <h2 id="sitemap-categories-heading" class="mb-4 flex items-center gap-3 text-xl font-semibold text-ink">
                <span class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary" aria-hidden="true">
                    <i data-lucide="folder-open" class="w-5 h-5"></i>
                </span>
                Kategoriler
                <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-sm font-medium text-primary">@Model.Categories.Count</span>
            </h2>
            <ul class="max-h-80 space-y-1 overflow-y-auto pr-1" role="list">
                @foreach (var category in Model.Categories)
                {
                    <li>
                        <a href="/category/@category.Slug" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">@category.Name</a>
                    </li>
                }
            </ul>
        </section>

        <!-- Alt Kategoriler -->
        <section aria-labelledby="sitemap-subcategories-heading" class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
            <h2 id="sitemap-subcategories-heading" class="mb-4 flex items-center gap-3 text-xl font-semibold text-ink">
                <span class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary" aria-hidden="true">
                    <i data-lucide="folder" class="w-5 h-5"></i>
                </span>
                Alt Kategoriler
                <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-sm font-medium text-primary">@Model.SubCategories.Count</span>
            </h2>
            <ul class="max-h-80 space-y-1 overflow-y-auto pr-1" role="list">
                @foreach (var subCategory in Model.SubCategories)
                {
                    <li>
                        <a href="/category/@subCategory.CategorySlug/@subCategory.Slug" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">@subCategory.Name</a>
                    </li>
                }
            </ul>
        </section>

        <!-- Blog Yazıları -->
        <section aria-labelledby="sitemap-blogs-heading" class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
            <h2 id="sitemap-blogs-heading" class="mb-4 flex items-center gap-3 text-xl font-semibold text-ink">
                <span class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary" aria-hidden="true">
                    <i data-lucide="book-open" class="w-5 h-5"></i>
                </span>
                Blog Yazıları
                <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-sm font-medium text-primary">@Model.Blogs.Count</span>
            </h2>
            <ul class="max-h-80 space-y-1 overflow-y-auto pr-1" role="list">
                @foreach (var blog in Model.Blogs.Take(50))
                {
                    <li>
                        <a href="/blog/@blog.Slug" class="flex items-center gap-2 rounded-lg px-3 py-2 text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">@blog.Title</a>
                    </li>
                }
                @if (Model.Blogs.Count > 50)
                {
                    <li>
                        <a asp-page="/Blog" class="flex items-center gap-2 rounded-lg px-3 py-2 font-medium text-primary transition-colors hover:bg-primary/5 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">
                            <i data-lucide="plus-circle" class="w-4 h-4 flex-shrink-0"></i>
                            Tüm Blog Yazıları (@Model.Blogs.Count)
                        </a>
                    </li>
                }
            </ul>
        </section>
    </div>

    @if (Model.Products.Any())
    {
        <section aria-labelledby="sitemap-products-heading" class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
            <h2 id="sitemap-products-heading" class="mb-6 flex items-center gap-3 text-xl font-semibold text-ink">
                <span class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary" aria-hidden="true">
                    <i data-lucide="package-open" class="w-5 h-5"></i>
                </span>
                Ürünlerimiz
                <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-sm font-medium text-primary">@Model.Products.Count</span>
            </h2>
            <div class="space-y-8">
                @foreach (var categoryGroup in Model.Products.GroupBy(p => p.CategoryName).OrderBy(g => g.Key))
                {
                    <div class="border-b border-gray-100 pb-6 last:border-0 last:pb-0">
                        <h3 class="mb-3 flex items-center gap-2 text-base font-semibold text-ink">
                            <i data-lucide="tag" class="w-4 h-4 text-primary" aria-hidden="true"></i>
                            @categoryGroup.Key
                            <span class="text-sm font-normal text-gray-500">(@categoryGroup.Count())</span>
                        </h3>
                        <ul class="grid grid-cols-1 gap-1 sm:grid-cols-2 lg:grid-cols-3" role="list">
                            @foreach (var product in categoryGroup.Take(20))
                            {
                                <li>
                                    <a href="/category/@product.CategorySlug/@product.SubCategorySlug/@product.Slug" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-50 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">@product.Name</a>
                                </li>
                            }
                        </ul>
                        @if (categoryGroup.Count() > 20)
                        {
                            <a href="/category/@categoryGroup.First().CategorySlug" class="mt-3 inline-flex items-center gap-2 rounded-lg bg-gray-100 px-4 py-2 text-sm font-medium text-ink transition-colors hover:bg-primary/10 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2">
                                <i data-lucide="plus-circle" class="w-4 h-4" aria-hidden="true"></i>
                                @categoryGroup.Key kategorisindeki tüm ürünler (+@(categoryGroup.Count() - 20))
                            </a>
                        }
                    </div>
                }
            </div>
        </section>
    }

    <!-- SEO / XML bilgisi -->
    <section aria-labelledby="sitemap-about-heading" class="rounded-xl border border-gray-100 bg-white p-6 shadow-sm md:p-8">
        <div class="flex flex-col gap-6 sm:flex-row sm:items-start">
            <span class="flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-primary text-white" aria-hidden="true">
                <i data-lucide="search" class="w-6 h-6"></i>
            </span>
            <div class="min-w-0 flex-1">
                <h2 id="sitemap-about-heading" class="text-xl font-semibold text-ink">Site Haritası Hakkında</h2>
                <p class="mt-2 text-gray-600 leading-relaxed">
                    Bu sayfa, sitedeki tüm içeriklere kolay erişim sağlamak için hazırlanmıştır. Arama motorları için XML site haritamıza <a href="/sitemap.xml" target="_blank" rel="noopener noreferrer" class="font-medium text-primary underline transition-colors hover:text-primary-dark focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2 rounded">buradan</a> ulaşabilirsiniz.
                </p>
                <p class="mt-3 text-sm text-gray-500">
                    Toplam: @Model.Categories.Count kategori, @Model.SubCategories.Count alt kategori, @Model.Products.Count ürün, @Model.Blogs.Count blog yazısı.
                </p>
            </div>
        </div>
    </section>
</article>
