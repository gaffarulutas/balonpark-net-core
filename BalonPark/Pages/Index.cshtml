@page
@model IndexModel
@{
    var settings = ViewData["SiteSettings"] as BalonPark.Models.Settings;
    var companyName = settings?.CompanyName ?? "Balon Park ÅiÅŸme Oyun GruplarÄ±";
    
    ViewData["Title"] = $"ÅiÅŸme Oyun ParklarÄ± ve Ã‡ocuk Oyun GruplarÄ± | {settings?.MetaTitle ?? companyName}";
    ViewData["Description"] = "TÃ¼rkiye'nin en kaliteli ÅŸiÅŸme oyun parklarÄ±, kaydÄ±raklar, havuzlar ve Ã§ocuk oyun gruplarÄ±. GÃ¼venli, dayanÄ±klÄ± ve eÄŸlenceli Ã¼rÃ¼nler. HÄ±zlÄ± teslimat ve uygun fiyatlar. Ã‡ocuklarÄ±nÄ±z iÃ§in en iyi oyun deneyimi!";
    ViewData["Keywords"] = "ÅŸiÅŸme oyun parkÄ±, ÅŸiÅŸme kaydÄ±rak, ÅŸiÅŸme havuz, ÅŸiÅŸme rodeo, top havuzu, iÃ§ mekan oyun parklarÄ±, trambolin, softplay oyuncaklar, yer balonlarÄ±, balon tak, fly tÃ¼p, ÅŸiÅŸme kostÃ¼m, reklam balonlarÄ±, balon park, Ã§ocuk oyun gruplarÄ±, ÅŸiÅŸme oyuncaklar, Ã§ocuk parkÄ±, oyun alanÄ±, eÄŸlence parkÄ±, Ã§ocuk eÄŸlence merkezi";
    ViewData["Image"] = settings?.Logo != null ? (((IUrlService?)ViewData["UrlService"])?.GetImageUrl(settings.Logo) ?? settings.Logo) : (((IUrlService?)ViewData["UrlService"])?.GetImageUrl("/assets/images/logo/logo.png") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/assets/images/logo/logo.png");
}

<!-- Additional SEO Structured Data for Homepage -->
<script type="application/ld+json">
{
    "@@context": "https://schema.org",
    "@@type": "WebSite",
    "name": "@Html.Raw(companyName)",
    "alternateName": "@Html.Raw(companyName.Replace(" ", ""))",
    "url": "@(((IUrlService?)ViewData["UrlService"])?.GetPageUrl("/") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/")",
    "description": "@Html.Raw(settings?.About ?? "TÃ¼rkiye'nin en kaliteli ÅŸiÅŸme oyun parklarÄ±, kaydÄ±raklar, havuzlar ve Ã§ocuk oyun gruplarÄ± Ã¼reticisi")",
    "potentialAction": {
        "@@type": "SearchAction",
        "target": "@(((IUrlService?)ViewData["UrlService"])?.GetPageUrl("/Search") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/Search")?q={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    "publisher": {
        "@@type": "Organization",
        "name": "@Html.Raw(companyName)",
        "logo": {
            "@@type": "ImageObject",
            "url": "@(settings?.Logo != null ? (((IUrlService?)ViewData["UrlService"])?.GetImageUrl(settings.Logo) ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}{settings.Logo}") : (((IUrlService?)ViewData["UrlService"])?.GetImageUrl("/assets/images/logo/logo.png") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/assets/images/logo/logo.png"))"
        }
    }
}
</script>

<!-- Product Section Start -->

<div class="section-b-space">

    <div class="row g-md-4 g-3">
        <div class="col-xxl-8 col-xl-12 col-md-7">
            <div class="banner-contain">
                <img src="~/assets/images/1.png" class="bg-img blur-up lazyload" alt="ÅiÅŸme Oyun ParklarÄ± ve Ã‡ocuk Oyun GruplarÄ± - Balon Park EÄŸlence Merkezi" loading="lazy" width="800" height="400">
                <div class="banner-details p-center-left p-sm-5 p-4">
                    <div>
                        <h2 class="text-kaushan fw-normal" style="color: #6262a6;">HazÄ±r Olun</h2>
                        <h3 class="mt-2 mb-3 text-danger">EÄLENCEYE!</h3>
                        <p class="text-content banner-text text-kaushan opacity-75 d-md-block d-none">
                            Ã‡ocuklarÄ±nÄ±z iÃ§in gÃ¼venli ve eÄŸlenceli ÅŸiÅŸme oyun gruplarÄ± ile 
                            unutulmaz anlar yaÅŸayÄ±n.</p>
                        <button onclick="location.href = '/category/sisme-parklar/sisme-kaydirak';" class="btn modern-cta-btn btn-sm mend-auto">ÃœrÃ¼nleri GÃ¶r
                            <i class="fa-solid fa-arrow-right icon"></i></button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xxl-4 col-xl-12 col-md-5">
            <div class="banner-contain h-100">
                <img src="~/assets/images/2.png" class="bg-img blur-up lazyload" alt="">
                <div class="banner-details p-center-left p-4 h-100">
                    <div>
                        <h2 class="text-kaushan fw-normal" style="color: #6262a6;">Kaliteli</h2>
                        <h3 class="mt-2 mb-3 text-dark">GÃ¼venli</h3>
                        <p class="text-content banner-text w-100">En Ä°yi Fiyatlarla
                            Sizlerle</p>
                        <button onclick="location.href = '/category/sisme-parklar/sisme-oyun-parki';" class="btn modern-cta-btn btn-sm mend-auto">ÃœrÃ¼nleri GÃ¶r
                            <i class="fa-solid fa-arrow-right icon"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="title d-block ">
    <h2 class="font-sm" style="color: #6262a6;">Ã–ne Ã‡Ä±kan ÃœrÃ¼nler</h2>
    <p style="color: #6b7280;">TÃ¼m kategorilerden seÃ§ilmiÅŸ harika Ã¼rÃ¼nlerimizi keÅŸfedin</p>
</div>

<div class="row row-cols-xxl-6 row-cols-lg-5 row-cols-md-4 row-cols-sm-3 row-cols-2 g-sm-4 g-3 mb-5">
    @if (Model.Products.Any())
    {
        @foreach (var item in Model.Products)
        {
            <div>
                <div class="product-box modern-product-card wow fadeIn">
                    <!-- Product Actions -->
                    <div class="product-actions">
                        <button class="favorite-btn" data-product-id="@item.Product.Id">
                            <i class="fa-regular fa-heart"></i>
                            <span class="btn-text">Favori</span>
                        </button>
                        <button class="compare-btn" data-product-id="@item.Product.Id">
                            <i class="fa-solid fa-shuffle"></i>
                            <span class="btn-text">KarÅŸÄ±laÅŸtÄ±r</span>
                        </button>
                    </div>

                    <div class="product-image">
                        <a href="/category/@item.Product.CategorySlug/@item.Product.SubCategorySlug/@item.Product.Slug">
                            @if (item.MainImage != null)
                            {
                                <img src="@(((IUrlService?)ViewData["UrlService"])?.GetImageUrl(item.MainImage.ThumbnailPath) ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/{item.MainImage.ThumbnailPath}")" class="img-fluid blur-up lazyload product-thumbnail"
                                    alt="@Html.Raw(item.Product.Name)">
                            }
                            else
                            {
                                <img src="@(((IUrlService?)ViewData["UrlService"])?.GetImageUrl("/assets/images/no-image.png") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/assets/images/no-image.png")" class="img-fluid blur-up lazyload product-thumbnail" alt="@Html.Raw(item.Product.Name)">
                            }
                        </a>
                    </div>
                    <div class="product-detail position-relative">
                        <a href="/category/@item.Product.CategorySlug/@item.Product.SubCategorySlug/@item.Product.Slug">
                            <h6 class="name">@Html.Raw(item.Product.Name)</h6>
                        </a>

                        <h6 class="sold weight text-content fw-normal">@Html.Raw(item.Product.CategoryName)</h6>

                        @if (!string.IsNullOrEmpty(item.Product.Description))
                        {
                            <p class="product-description text-content">
                                @Html.Raw(item.Product.Description.Length > 60 ? item.Product.Description.Substring(0, 60) + "..." : item.Product.Description)
                            </p>
                        }

                        @if (!string.IsNullOrEmpty(item.Product.Dimensions))
                        {
                            <div class="product-dimensions">
                                <i class="fa-solid fa-ruler-combined"></i>
                                <span class="dimensions-text">@Html.Raw(item.Product.Dimensions)</span>
                            </div>
                        }

                        <div class="price-section">
                            @if (item.Product.Price <= 0)
                            {
                                <p class="price-contact-text">Fiyat iÃ§in iletiÅŸime geÃ§in</p>
                            }
                            else
                            {
                                <h6 class="price price-tl @(Model.SelectedCurrency == "TL" ? "active" : "")" style="color: #6262a6;">â‚º@item.Product.Price.ToString("N2")</h6>
                                <h6 class="price price-usd @(Model.SelectedCurrency == "USD" ? "active" : "")" style="color: #6262a6;">$@item.Product.UsdPrice.ToString("N2")</h6>
                                <h6 class="price price-eur @(Model.SelectedCurrency == "EUR" ? "active" : "")" style="color: #6262a6;">â‚¬@item.Product.EuroPrice.ToString("N2")</h6>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
            <div class="alert alert-info text-center" style="margin-top: 20px;width: 100%;">
                <h5>Åu anda Ã¼rÃ¼n bulunmamaktadÄ±r</h5>
                <p>LÃ¼tfen daha sonra tekrar kontrol edin veya daha fazla bilgi iÃ§in bizimle iletiÅŸime geÃ§in.</p>
            </div>
    }
</div>

@if (Model.TotalPages > 1)
{
    <div class="pagination-container text-center mt-4">
        <nav aria-label="Sayfa navigasyonu">
            <ul class="pagination justify-content-center">
                @if (Model.CurrentPage > 1)
                {
                    <li class="page-item">
                        <a class="page-link" href="?PageNumber=@(Model.CurrentPage - 1)" aria-label="Ã–nceki">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                }
                
                @{
                    int startPage = Math.Max(1, Model.CurrentPage - 2);
                    int endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
                }
                
                @if (startPage > 1)
                {
                    <li class="page-item">
                        <a class="page-link" href="?PageNumber=1">1</a>
                    </li>
                    @if (startPage > 2)
                    {
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    }
                }
                
                @for (int i = startPage; i <= endPage; i++)
                {
                    <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                        @if (i == Model.CurrentPage)
                        {
                            <span class="page-link active">@i</span>
                        }
                        else
                        {
                            <a class="page-link" href="?PageNumber=@i">@i</a>
                        }
                    </li>
                }
                
                @if (endPage < Model.TotalPages)
                {
                    @if (endPage < Model.TotalPages - 1)
                    {
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    }
                    <li class="page-item">
                        <a class="page-link" href="?PageNumber=@Model.TotalPages">@Model.TotalPages</a>
                    </li>
                }
                
                @if (Model.CurrentPage < Model.TotalPages)
                {
                    <li class="page-item">
                        <a class="page-link" href="?PageNumber=@(Model.CurrentPage + 1)" aria-label="Sonraki">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                }
            </ul>
        </nav>
        
        <div class="pagination-info mt-2">
            <small class="text-muted">
                Sayfa @Model.CurrentPage / @Model.TotalPages 
                (@Model.TotalProducts Ã¼rÃ¼n)
            </small>
        </div>
    </div>
}
<!-- Product Section End -->

@section Scripts {
<script>
    // Pagination Debug
    document.addEventListener('DOMContentLoaded', function() {
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log('ğŸ  Index Page - Pagination Debug');
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log('CurrentPage (Model):', @Model.CurrentPage);
        console.log('TotalPages:', @Model.TotalPages);
        console.log('TotalProducts:', @Model.TotalProducts);
        console.log('PageSize:', @Model.PageSize);
        console.log('Products Count:', @Model.Products.Count);
        console.log('URL:', window.location.href);
        console.log('Query String:', window.location.search);
        
        const urlParams = new URLSearchParams(window.location.search);
        console.log('PageNumber param from URL:', urlParams.get('PageNumber'));
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    });
</script>
}
