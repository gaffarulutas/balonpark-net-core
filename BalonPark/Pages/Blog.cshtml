@page
@model BalonPark.Pages.BlogModel
@{
    Layout = "_Layout";
    var settings = ViewData["SiteSettings"] as BalonPark.Models.Settings;
    var companyName = settings?.CompanyName ?? "Balon Park Şişme Oyun Grupları";
    ViewData["Title"] = $"Blog - {settings?.MetaTitle ?? companyName}";
    ViewData["Description"] = $"{companyName} blog sayfasında şişme oyun parkları, çocuk eğlence alanları ve bakım ipuçları hakkında güncel yazıları keşfedin.";
    ViewData["Keywords"] = "blog, şişme oyun parkı, çocuk oyun alanı, şişme kaydırak, şişme havuz, balon park";
}

<!-- Blog Collection Structured Data -->
<script type="application/ld+json">
    {
        "@@context": "https://schema.org",
        "@@type": "CollectionPage",
        "name": "Blog - @Html.Raw(companyName)",
    "description": "@Html.Raw(companyName) blog sayfasında şişme oyun parkları, çocuk eğlence alanları ve bakım ipuçları hakkında güncel yazıları keşfedin.",
    "url": "@(((IUrlService?)ViewData["UrlService"])?.GetPageUrl("/blog") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/blog")",
    "mainEntity": {
        "@@type": "ItemList",
        "name": "Blog Yazıları",
        "description": "Şişme oyun parkları ve çocuk eğlence alanları hakkında blog yazıları",
        "numberOfItems": "@Model.Blogs.Count",
        "itemListElement": [
    @for (var i = 0; i < Model.Blogs.Count && i < 10; i++)
    {
        var blog = Model.Blogs[i];
        @: {
        @:     "@@type": "ListItem",
        @:     "position": @(i + 1),
        @:     "item": {
        @:         "@@type": "BlogPosting",
        @:         "headline": "@Html.Raw(blog.Title)",
        @:         "description": "@Html.Raw(blog.Excerpt ?? blog.Title)",
        @:         "url": "@(((IUrlService?)ViewData["UrlService"])?.GetPageUrl($"/blog/{blog.Slug}") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/blog/{blog.Slug}")",
        @:         "image": "@(((IUrlService?)ViewData["UrlService"])?.GetImageUrl(blog.FeaturedImage ?? "/assets/images/logo/logo.png") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/{(blog.FeaturedImage ?? "/assets/images/logo/logo.png")}")",
        @:         "datePublished": "@blog.CreatedAt.ToString("yyyy-MM-dd")",
        @:         "dateModified": "@(blog.UpdatedAt?.ToString("yyyy-MM-dd") ?? blog.CreatedAt.ToString("yyyy-MM-dd"))",
        @:         "author": {
        @:             "@@type": "Organization",
        @:             "name": "Balon Park Şişme Oyun Grupları"
        @:         },
        @:         "publisher": {
        @:             "@@type": "Organization",
        @:             "name": "Balon Park Şişme Oyun Grupları",
        @:             "logo": {
        @:                 "@@type": "ImageObject",
        @:                 "url": "@(((IUrlService?)ViewData["UrlService"])?.GetImageUrl("/assets/images/logo/logo.png") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/assets/images/logo/logo.png")"
        @:             }
        @:         }
        @:     }
        @: }@(i < Math.Min(Model.Blogs.Count, 10) - 1 ? "," : "")
    }
    ]
},
"breadcrumb": {
    "@@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@@type": "ListItem",
            "position": 1,
            "name": "Ana Sayfa",
            "item": "@(((IUrlService?)ViewData["UrlService"])?.GetPageUrl("/") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/")"
            },
            {
                "@@type": "ListItem",
                "position": 2,
                "name": "Blog",
                "item": "@(((IUrlService?)ViewData["UrlService"])?.GetPageUrl("/blog") ?? $"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}/blog")"
            }
        ]
    }
}
</script>

<!-- Blog Section Start -->
<div class="section-b-space"></div>

    @section Styles {
        <style>
            .section-title h2 {
                color: #333;
                font-weight: 700;
                margin-bottom: 1rem;
            }

            .section-subtitle {
                color: #666;
                font-size: 1.1rem;
            }

            .blog-card {
                border: 1px solid #e1e5e9;
                border-radius: 15px;
                overflow: hidden;
                transition: all 0.3s ease;
                background: white;
                margin-bottom: 2rem;
                box-shadow: var(--shadow-light);
            }

            .blog-card:hover {
                transform: translateY(-4px);
                box-shadow: var(--shadow-medium);
            }

            .blog-card-image {
                width: 100%;
                height: 250px;
                object-fit: cover;
                background: var(--secondary-color);
            }

            .blog-card-content {
                padding: 1.5rem;
            }

            .blog-card-title {
                font-size: 1.3rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
                line-height: 1.4;
            }

            .blog-card-title a {
                color: #333;
                text-decoration: none;
                transition: color 0.3s ease;
            }

            .blog-card-title a:hover {
                color: #007bff;
            }

            .blog-card-excerpt {
                color: var(--text-light);
                line-height: 1.6;
                margin-bottom: 1rem;
            }

            .blog-card-meta {
                display: flex;
                align-items: center;
                gap: 1rem;
                font-size: 0.9rem;
                color: var(--text-light);
                margin-bottom: 1rem;
            }

            .blog-card-meta span {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .blog-card-meta i {
                font-size: 1rem;
            }

            .blog-card-category {
                display: inline-block;
                background: var(--primary-color);
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 500;
                text-decoration: none;
                transition: all 0.3s ease;
            }

            .blog-card-category:hover {
                background: #4a4a8a;
                color: white;
                transform: translateY(-2px);
                box-shadow: var(--shadow-light);
            }

            .blog-sidebar {
                background: white;
                border-radius: var(--border-radius);
                padding: 1.5rem;
                margin-bottom: 2rem;
                box-shadow: var(--shadow-light);
                border: 1px solid var(--border-color);
            }

            .blog-sidebar h3 {
                font-size: 1.2rem;
                font-weight: 600;
                margin-bottom: 1rem;
                color: var(--text-dark);
            }

            .featured-blog-item {
                display: flex;
                gap: 1rem;
                margin-bottom: 1rem;
                padding-bottom: 1rem;
                border-bottom: 1px solid var(--border-color);
            }

            .featured-blog-item:last-child {
                border-bottom: none;
                margin-bottom: 0;
                padding-bottom: 0;
            }

            .featured-blog-image {
                width: 80px;
                height: 60px;
                object-fit: cover;
                border-radius: var(--border-radius);
                background: var(--secondary-color);
            }

            .featured-blog-content h4 {
                font-size: 0.9rem;
                font-weight: 600;
                margin-bottom: 0.5rem;
                line-height: 1.3;
            }

            .featured-blog-content h4 a {
                color: var(--text-dark);
                text-decoration: none;
                transition: color 0.3s ease;
            }

            .featured-blog-content h4 a:hover {
                color: var(--primary-color);
            }

            .featured-blog-date {
                font-size: 0.8rem;
                color: var(--text-light);
            }

            .pagination {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 0.5rem;
                margin-top: 3rem;
            }

            .pagination .page-link {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 40px;
                height: 40px;
                border: 1px solid #e1e5e9;
                border-radius: 8px;
                color: #666;
                text-decoration: none;
                font-weight: 500;
                transition: all 0.3s ease;
                background: white;
            }

            .pagination .page-link:hover {
                background: #007bff;
                color: white;
                border-color: #007bff;
                transform: translateY(-2px);
                box-shadow: 0 2px 10px rgba(0, 123, 255, 0.3);
            }

            .pagination .page-link.active {
                background: #007bff;
                color: white;
                border-color: #007bff;
            }

            .pagination .page-link.disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .blog-search {
                margin-bottom: 2rem;
                background: white;
                padding: 1.5rem;
                border-radius: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                border: 1px solid #e1e5e9;
            }

            .blog-search .form-control {
                border-radius: 8px;
                border: 2px solid #e1e5e9;
                padding: 0.75rem 1rem;
                font-size: 1rem;
                transition: all 0.3s ease;
            }

            .blog-search .form-control:focus {
                border-color: #007bff;
                box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
            }

            .blog-search .btn {
                background: #007bff;
                border: none;
                border-radius: 8px;
                padding: 0.75rem 1.5rem;
                color: white;
                font-weight: 500;
                transition: all 0.3s ease;
            }

            .blog-search .btn:hover {
                background: #0056b3;
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
            }

            .no-blogs {
                text-align: center;
                padding: 3rem 1rem;
                color: #666;
                background: white;
                border-radius: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                border: 1px solid #e1e5e9;
            }

            .no-blogs i {
                font-size: 3rem;
                margin-bottom: 1rem;
                opacity: 0.5;
            }

            .blog-categories {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                margin-bottom: 2rem;
                background: white;
                padding: 1.5rem;
                border-radius: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                border: 1px solid #e1e5e9;
            }

            .category-tag {
                background: #f8f9fa;
                border: 1px solid #e1e5e9;
                color: #666;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                text-decoration: none;
                font-size: 0.9rem;
                transition: all 0.3s ease;
            }

            .category-tag:hover,
            .category-tag.active {
                background: #007bff;
                color: white;
                border-color: #007bff;
                transform: translateY(-2px);
                box-shadow: 0 2px 10px rgba(0, 123, 255, 0.3);
            }

            .btn-outline-primary {
                border-color: #007bff;
                color: #007bff;
            }

            .btn-outline-primary:hover {
                background-color: #007bff;
                border-color: #007bff;
                color: white;
            }

            @@media (max-width: 768px) {
                .blog-hero h1 {
                    font-size: 2rem;
                }

                .blog-hero p {
                    font-size: 1rem;
                }

                .featured-blog-item {
                    flex-direction: column;
                }

                .featured-blog-image {
                    width: 100%;
                    height: 120px;
                }

                .blog-card-image {
                    height: 200px;
                }

                .blog-search,
                .blog-categories,
                .blog-sidebar {
                    margin: 1rem 0;
                }
            }
        </style>
    }
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Ana İçerik -->
            <div class="col-lg-8">
                <!-- Blog Arama -->
                <div class="blog-search">
                    <form method="get" asp-page="/Blog">
                        <div class="row">
                            <div class="col-md-9">
                                <input type="text" name="q" class="form-control" placeholder="Blog yazılarında ara..."
                                       value="@Model.SearchQuery">
                            </div>
                            <div class="col-md-3">
                                <button type="submit" class="btn w-100">
                                    <i class="fas fa-search me-2"></i>Ara
                                </button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Kategori Filtreleri -->
                @if (Model.BlogCategories?.Any() == true)
                {
                    <div class="blog-categories">
                        <a href="/blog"
                           class="category-tag @(string.IsNullOrEmpty(Model.SelectedCategory) ? "active" : "")">
                            Tümü
                        </a>
                        @foreach (var category in Model.BlogCategories)
                        {
                            <a href="/blog?category=@Uri.EscapeDataString(category)"
                               class="category-tag @(Model.SelectedCategory == category ? "active" : "")">
                                @category
                            </a>
                        }
                    </div>
                }

                <!-- Blog Listesi -->
                @if (Model.Blogs?.Any() == true)
                {
                    <div class="row">
                        @foreach (var blog in Model.Blogs)
                        {
                            <div class="col-md-6 mb-4">
                                <article class="blog-card">
                                    <div class="blog-card-image-container">
                                        @if (!string.IsNullOrEmpty(blog.FeaturedImage))
                                        {
                                            <img src="@Model.UrlService?.GetImageUrl(blog.FeaturedImage)"
                                                 alt="@Html.Raw(blog.Title)"
                                                 class="blog-card-image"
                                                 loading="lazy">
                                        }
                                        else
                                        {
                                            <div
                                                class="blog-card-image d-flex align-items-center justify-content-center">
                                                <i class="fas fa-image text-muted" style="font-size: 3rem;"></i>
                                            </div>
                                        }
                                    </div>

                                    <div class="blog-card-content">
                                        @if (!string.IsNullOrEmpty(blog.Category))
                                        {
                                            <a href="/blog?category=@Uri.EscapeDataString(blog.Category)"
                                               class="blog-card-category">
                                                @Html.Raw(blog.Category)
                                            </a>
                                        }

                                        <h2 class="blog-card-title">
                                            <a href="/blog/@blog.Slug">@Html.Raw(blog.Title)</a>
                                        </h2>

                                        @if (!string.IsNullOrEmpty(blog.Excerpt))
                                        {
                                            <p class="blog-card-excerpt">@Html.Raw(blog.Excerpt)</p>
                                        }

                                        <div class="blog-card-meta">
                                            <span>
                                                <i class="fas fa-user"></i>
                                                @(blog.AuthorName ?? companyName)
                                            </span>
                                            <span>
                                                <i class="fas fa-calendar"></i>
                                                @(blog.PublishedAt?.ToString("dd.MM.yyyy") ?? blog.CreatedAt.ToString("dd.MM.yyyy"))
                                            </span>
                                            @if (blog.ViewCount > 0)
                                            {
                                                <span>
                                                    <i class="fas fa-eye"></i>
                                                    @blog.ViewCount görüntüleme
                                                </span>
                                            }
                                        </div>
                                    </div>
                                </article>
                            </div>
                        }
                    </div>

                    <!-- Sayfalama -->
                    @if (Model.TotalPages > 1)
                    {
                        <nav class="pagination">
                            @if (Model.CurrentPage > 1)
                            {
                                <a href="/blog?page=@(Model.CurrentPage - 1)@(string.IsNullOrEmpty(Model.SearchQuery) ? "" : $"&q={Uri.EscapeDataString(Model.SearchQuery)}")@(string.IsNullOrEmpty(Model.SelectedCategory) ? "" : $"&category={Uri.EscapeDataString(Model.SelectedCategory)}")"
                                   class="page-link">
                                    <i class="fas fa-chevron-left"></i>
                                </a>
                            }

                            @for (int i = Math.Max(1, Model.CurrentPage - 2); i <= Math.Min(Model.TotalPages, Model.CurrentPage + 2); i++)
                            {
                                @if (i == Model.CurrentPage)
                                {
                                    <span class="page-link active">@i</span>
                                }
                                else
                                {
                                    <a href="/blog?page=@i@(string.IsNullOrEmpty(Model.SearchQuery) ? "" : $"&q={Uri.EscapeDataString(Model.SearchQuery)}")@(string.IsNullOrEmpty(Model.SelectedCategory) ? "" : $"&category={Uri.EscapeDataString(Model.SelectedCategory)}")"
                                       class="page-link">
                                        @i
                                    </a>
                                }
                            }

                            @if (Model.CurrentPage < Model.TotalPages)
                            {
                                <a href="/blog?page=@(Model.CurrentPage + 1)@(string.IsNullOrEmpty(Model.SearchQuery) ? "" : $"&q={Uri.EscapeDataString(Model.SearchQuery)}")@(string.IsNullOrEmpty(Model.SelectedCategory) ? "" : $"&category={Uri.EscapeDataString(Model.SelectedCategory)}")"
                                   class="page-link">
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            }
                        </nav>
                    }
                }
                else
                {
                    <div class="no-blogs">
                        <i class="fas fa-newspaper"></i>
                        <h3>Henüz blog yazısı bulunmuyor</h3>
                        <p>Yakında güncel blog yazılarımızı paylaşacağız.</p>
                    </div>
                }
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Öne Çıkan Yazılar -->
                @if (Model.FeaturedBlogs?.Any() == true)
                {
                    <div class="blog-sidebar">
                        <h3>Öne Çıkan Yazılar</h3>
                        @foreach (var featuredBlog in Model.FeaturedBlogs)
                        {
                            <div class="featured-blog-item">
                                @if (!string.IsNullOrEmpty(featuredBlog.FeaturedImage))
                                {
                                    <img src="@Model.UrlService?.GetImageUrl(featuredBlog.FeaturedImage)"
                                         alt="@Html.Raw(featuredBlog.Title)"
                                         class="featured-blog-image"
                                         loading="lazy">
                                }
                                else
                                {
                                    <div class="featured-blog-image d-flex align-items-center justify-content-center">
                                        <i class="fas fa-image text-muted"></i>
                                    </div>
                                }

                                <div class="featured-blog-content">
                                    <h4>
                                        <a href="/blog/@featuredBlog.Slug">@Html.Raw(featuredBlog.Title)</a>
                                    </h4>
                                    <div class="featured-blog-date">
                                        @(featuredBlog.PublishedAt?.ToString("dd.MM.yyyy") ?? featuredBlog.CreatedAt.ToString("dd.MM.yyyy"))
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }

                <!-- Son Yazılar -->
                @if (Model.LatestBlogs?.Any() == true)
                {
                    <div class="blog-sidebar">
                        <h3>Son Yazılar</h3>
                        @foreach (var latestBlog in Model.LatestBlogs)
                        {
                            <div class="featured-blog-item">
                                @if (!string.IsNullOrEmpty(latestBlog.FeaturedImage))
                                {
                                    <img src="@Model.UrlService?.GetImageUrl(latestBlog.FeaturedImage)"
                                         alt="@Html.Raw(latestBlog.Title)"
                                         class="featured-blog-image"
                                         loading="lazy">
                                }
                                else
                                {
                                    <div class="featured-blog-image d-flex align-items-center justify-content-center">
                                        <i class="fas fa-image text-muted"></i>
                                    </div>
                                }

                                <div class="featured-blog-content">
                                    <h4>
                                        <a href="/blog/@latestBlog.Slug">@Html.Raw(latestBlog.Title)</a>
                                    </h4>
                                    <div class="featured-blog-date">
                                        @(latestBlog.PublishedAt?.ToString("dd.MM.yyyy") ?? latestBlog.CreatedAt.ToString("dd.MM.yyyy"))
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }

                <!-- RSS Feed -->
                <div class="blog-sidebar">
                    <h3>Blog Aboneliği</h3>
                    <p class="mb-3">Blog yazılarımızı kaçırmamak için RSS aboneliği yapabilirsiniz.</p>
                    <a href="/blog/feed" class="btn btn-outline-primary w-100">
                        <i class="fas fa-rss me-2"></i>RSS Aboneliği
                    </a>
                </div>
            </div>
        </div>
    </div>
